# 周易占卜工具使用说明

## 概述

周易占卜工具已成功集成到 Frontier 机器人系统中。用户可以通过自然语言与机器人对话,AI Agent 会自动调用相应的周易占卜工具。

## 功能特性

### 三种起卦方法

1. **三枚铜钱法** (最传统准确)
   - 模拟投掷三枚铜钱六次
   - 自动计算本卦、变卦和动爻
   - 完整展示六爻信息

2. **时间起卦法**
   - 根据年月日时自动起卦
   - 适合快速占卜
   - 可使用当前时间或指定时间

3. **报数起卦法**
   - 通过两个数字起卦
   - 可随机生成或用户指定
   - 灵活简便

### 辅助功能

- **列出64卦** - 查看所有卦象列表
- **查看卦象详情** - 获取单个卦的完整信息
- **五行分类** - 按五行属性分类查看
- **八纯卦** - 查看八个纯卦的详细信息

## 使用示例

### 用户对话示例

#### 1. 基础占卜
```
用户: 帮我用周易占卜一下今年事业发展如何
机器人: [调用 iching_divination] → 返回完整占卜结果
```

#### 2. 指定起卦方法
```
用户: 用时间起卦看看我的感情运势
机器人: [调用 iching_divination(method="time")] → 使用当前时间起卦
```

#### 3. 报数起卦
```
用户: 我报数123和456,帮我起个卦
机器人: [调用 iching_divination(method="number", num1=123, num2=456)]
```

#### 4. 查询卦象
```
用户: 乾卦是什么意思
机器人: [调用 get_hexagram_detail("乾")] → 返回乾卦详细信息
```

#### 5. 浏览卦象
```
用户: 周易有哪些卦
机器人: [调用 list_iching_hexagrams()] → 显示64卦列表
```

## 输出格式

### 占卜结果包含

1. **基本信息**
   - 占卜问题
   - 起卦方法
   - 时间/数字信息

2. **本卦信息**
   - 卦名、卦号、卦象符号
   - 上下卦组成
   - 五行属性
   - 卦象图形(ASCII艺术)
   - 卦辞(原文+白话文)
   - 象辞(原文+白话文)

3. **动爻信息** (如有)
   - 动爻位置
   - 爻辞(原文+白话文)
   - 详细解释

4. **变卦信息** (如有)
   - 变卦名称和卦象
   - 变卦卦辞

5. **解读提示**
   - 运势分析
   - 事业建议
   - 感情指导
   - 健康提示
   - 综合建议

## 技术实现

### 文件结构

```
data/iching/
├── index.json              # 64卦索引
├── trigrams.json           # 八卦数据
├── hexagrams/              # 详细卦象数据
│   ├── 01_qian.json       # 乾卦
│   ├── 02_kun.json        # 坤卦
│   └── ...                # 其他卦象
└── README.md

tools/
├── iching.py              # 周易工具实现
└── __init__.py            # 工具注册
```

### 已实现的工具函数

1. **iching_divination** - 主占卜工具
   - 支持三种起卦方法
   - 完整的参数验证
   - 详细的错误处理

2. **list_iching_hexagrams** - 列出卦象
   - 支持多种筛选方式
   - 格式化显示

3. **get_hexagram_detail** - 查询卦象详情
   - 完整的卦象信息
   - 六爻详解

## 数据完成情况

### 已完成
- ✅ 八卦基础数据
- ✅ 64卦索引
- ✅ 第1卦 乾卦(完整数据)
- ✅ 第2卦 坤卦(完整数据)

### 待完成
- ⏳ 第3-64卦的详细数据

**说明**: 目前只有2个卦的完整数据,其余62卦需要逐步补充。在补充完成前:
- 工具功能完全正常
- 可正确起卦和查找卦象
- 但部分卦可能缺少详细的爻辞和解读

## 后续工作

### 优先级1: 补充卦象数据
建议优先完成以下卦象:
1. 八纯卦(6个): 震、巽、坎、离、艮、兑
2. 常用卦(4个): 泰、否、既济、未济
3. 其余54卦

### 优先级2: 增强功能
- 添加卦象图片渲染
- 支持互卦、错卦、综卦分析
- 添加历史占卜记录

### 优先级3: 用户体验
- 优化输出格式
- 添加更多解读提示
- 支持更多查询方式

## 测试验证

已通过的测试:
- ✅ 数据文件加载
- ✅ 八卦映射
- ✅ 卦象查找
- ✅ 三枚铜钱法模拟
- ✅ 时间起卦计算
- ✅ 报数起卦计算

所有核心算法和数据结构已验证正确。

## 维护说明

### 添加新卦象数据
1. 在 `data/iching/hexagrams/` 目录创建JSON文件
2. 文件名格式: `{序号}_{拼音}.json` (如 `03_zhun.json`)
3. 参考 `01_qian.json` 的格式填写数据
4. 确保JSON格式正确
5. 无需修改代码,工具会自动加载

### 数据格式要求
- UTF-8编码
- 标准JSON格式
- 包含所有必需字段
- 白话文翻译准确通俗

## 许可和版权

周易原文来自中国古代经典《易经》,为公共领域作品。
白话文翻译和解读提示为项目原创内容。
